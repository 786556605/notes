<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://notes.shichao.io/spec/ch2/">
        <link rel="shortcut icon" href="../../toki_32.png">
        

	<title>Chapter 2. Methodology - Shichao's Notes</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,400italic,500,600" rel="stylesheet">
        <link href="../../custom.css" rel="stylesheet">
        <link href="../../friendly.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Shichao's Notes</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">APUE <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../apue/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch1/">Chapter 1. UNIX System Overview</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch2/">Chapter 2. UNIX Standardization and Implementations</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch3/">Chapter 3. File I/O</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch4/">Chapter 4. Files and Directories</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch5/">Chapter 5. Standard I/O Library</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch6/">Chapter 6. System Data Files and Information</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch7/">Chapter 7. Process Environment</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch8/">Chapter 8. Process Control</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch9/">Chapter 9. Process Relationships</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch10/">Chapter 10. Signals</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch11/">Chapter 11. Threads</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch12/">Chapter 12. Thread Control</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch13/">Chapter 13. Daemon Processes</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch14/">Chapter 14. Advanced I/O</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch15/">Chapter 15. Interprocess Communication</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch16/">Chapter 16. Network IPC: Sockets</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../apue/ch17/">Chapter 17. Advanced IPC</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">LKD <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../lkd/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch1/">Chapter 1. Introduction to the Linux Kernel</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch2/">Chapter 2. Getting Started with the Kernel</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch3/">Chapter 3. Process Management</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch4/">Chapter 4. Process Scheduling</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch5/">Chapter 5. System Calls</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch6/">Chapter 6. Kernel Data Structures</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch7/">Chapter 7. Interrupts and Interrupt Handlers</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch8/">Chapter 8. Bottom Halves and Deferring Work</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch9/">Chapter 9. An Introduction to Kernel Synchronization</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch10/">Chapter 10. Kernel Synchronization Methods</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch11/">Chapter 11. Timers and Time Management</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch12/">Chapter 12. Memory Management</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch13/">Chapter 13. The Virtual Filesystem</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch14/">Chapter 14. The Block I/O Layer</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../lkd/ch15/">Chapter 15. The Process Address Space</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">UNP <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../unp/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch1/">Chapter 1. Introduction</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch2/">Chapter 2. The Transport Layer: TCP, UDP, and SCTP</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch3/">Chapter 3. Sockets Introduction</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch4/">Chapter 4. Elementary TCP Sockets</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch5/">Chapter 5. TCP Client/Server Example</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch6/">Chapter 6. I/O Multiplexing: The select and poll Functions</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../unp/ch7/">Chapter 7. Socket Options</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">TCPv1 <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../tcpv1/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch1/">Chapter 1. Introduction</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch2/">Chapter 2. The Internet Address Architecture</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch3/">Chapter 3. Link Layer</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch4/">Chapter 4. ARP: Address Resolution Protocol </a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch5/">Chapter 5. The Internet Protocol (IP)</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch6/">Chapter 6. System Configuration: DHCP and Autoconfiguration</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch7/">Chapter 7. Firewalls and Network Address Translation (NAT)</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch8/">Chapter 8. ICMPv4 and ICMPv6: Internet Control Message Protocol</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch9/">Chapter 9. Broadcasting and Local Multicasting (IGMP and MLD) </a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch10/">Chapter 10. User Datagram Protocol (UDP) and IP Fragmentation</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch11/">Chapter 11. Name Resolution and the Domain Name System (DNS)</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch12/">Chapter 12. TCP: The Transmission Control Protocol (Preliminaries)</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch13/">Chapter 13. TCP Connection Management</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch14/">Chapter 14. TCP Timeout and Retransmission</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch15/">Chapter 15. TCP Data Flow and Window Management</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch16/">Chapter 16. TCP Congestion Control</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch17/">Chapter 17. TCP Keepalive</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/ch18/">Chapter 18. Security: EAP, IPsec, TLS, DNSSEC, and DKIM</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../tcpv1/headers/">Headers</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">GOPL <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../gopl/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../gopl/ch1/">Chapter 1. Tutorial</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../gopl/ch2/">Chapter 2. Program Structure</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../gopl/ch3/">Chapter 3. Basic Data Types</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../gopl/ch4/">Chapter 4. Composite Types</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">TWGR <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../../twgr/">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../twgr/ch1/">Chapter 1. Bootstrapping your Ruby literacy</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../../twgr/ch2/">Chapter 2. Objects, methods, and local variables</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">SPEC <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                      
                        <li >
                            <a href="../">Contents</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../ch1/">Chapter 1. Introduction</a>
                        </li>
                      
                    
                      
                        <li class="active">
                            <a href="./">Chapter 2. Methodology</a>
                        </li>
                      
                    
                      
                        <li >
                            <a href="../ch3/">Chapter 3. Operating Systems</a>
                        </li>
                      
                    
                    </ul>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
            <!-- Hide pages from the navigation -->
            
            
                <li >
                    <a href="../../roadmap/">Roadmap</a>
                </li>
            
            
            
            <!-- Hide pages from the navigation -->
            
            
            </ul>
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    
                        <a href="https://github.com/shichao-an/notes/blob/master/docs/spec/ch2.md">
                    
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#chapter-2-methodology">Chapter 2. Methodology</a></li>
        
    
        <li class="main "><a href="#terminology">Terminology</a></li>
        
    
        <li class="main "><a href="#models">Models</a></li>
        
            <li><a href="#system-under-test">System under Test</a></li>
        
            <li><a href="#queueing-system">Queueing System</a></li>
        
    
        <li class="main "><a href="#concepts">Concepts</a></li>
        
            <li><a href="#latency">Latency</a></li>
        
            <li><a href="#time-scales">Time Scales</a></li>
        
            <li><a href="#trade-offs">Trade-offs</a></li>
        
            <li><a href="#tuning-efforts">Tuning Efforts</a></li>
        
            <li><a href="#level-of-appropriateness">Level of Appropriateness</a></li>
        
            <li><a href="#point-in-time-recommendations">Point-in-Time Recommendations</a></li>
        
            <li><a href="#load-versus-architecture">Load versus Architecture</a></li>
        
            <li><a href="#scalability">Scalability</a></li>
        
            <li><a href="#known-unknowns">Known-Unknowns</a></li>
        
            <li><a href="#metrics">Metrics</a></li>
        
            <li><a href="#utilization">Utilization</a></li>
        
            <li><a href="#saturation">Saturation</a></li>
        
            <li><a href="#profiling">Profiling</a></li>
        
            <li><a href="#caching">Caching</a></li>
        
    
        <li class="main "><a href="#perspectives">Perspectives</a></li>
        
    
        <li class="main "><a href="#methodology">Methodology</a></li>
        
    
        <li class="main "><a href="#modeling">Modeling</a></li>
        
    
        <li class="main "><a href="#capacity-planning">Capacity Planning</a></li>
        
    
        <li class="main "><a href="#statistics">Statistics</a></li>
        
    
        <li class="main "><a href="#monitoring">Monitoring</a></li>
        
    
        <li class="main "><a href="#visualizations">Visualizations</a></li>
        
    
        <li class="main "><a href="#doubts-and-solutions">Doubts and Solutions</a></li>
        
            <li><a href="#verbatim">Verbatim</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">
              

<h3 id="chapter-2-methodology"><strong>Chapter 2. Methodology</strong></h3>
<p>Performance issues can arise from software, hardware, and any component along the data path. Methodologies help us approach complex systems by showing where to start and what steps to take to locate and analyze performance issues. [p15]</p>
<h3 id="terminology">Terminology</h3>
<p>The following are key terms for systems performance. Later chapters provide additional terms and describe some of these in different contexts.</p>
<ul>
<li><strong>IOPS</strong>: Input/output operations per second is a measure of the rate of data transfer operations.<ul>
<li>For disk I/O, IOPS refers to reads and writes per second.</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Throughput"><strong>Throughput</strong></a>: the rate of work performed. Especially in communications, the term is used to refer to the <a href="https://en.wikipedia.org/wiki/Data_rate_units">data rate</a> (bytes per second or bits per second).<ul>
<li>In some contexts (e.g., databases), throughput can refer to the operation rate (operations per second or transactions per second).</li>
</ul>
</li>
<li><strong>Response time</strong>: the time for an operation to complete. This includes any time spent waiting and time spent being serviced (service time), including the time to transfer the result.</li>
<li><strong>Latency</strong>: Latency is a measure of time an operation spends waiting to be serviced.<ul>
<li>In some contexts, it can refer to the entire time for an operation, equivalent to response time (<a href="#Concepts">Section 2.3</a>).</li>
</ul>
</li>
<li><strong>Utilization</strong>:<ul>
<li>For resources that service requests, utilization is a measure of how busy a resource is, based on how much time in a given interval it was actively performing work.</li>
<li>For resources that provide storage, utilization may refer to the capacity that is consumed (e.g., memory utilization).</li>
</ul>
</li>
<li><strong>Saturation</strong>: the degree to which a resource has queued work it cannot service.</li>
<li><strong>Bottleneck</strong>: In system performance, a bottleneck is a resource that limits the performance of the system. Identifying and removing systemic bottlenecks is a key activity of systems performance.</li>
<li><strong>Workload</strong>: The input to the system or the load applied is the workload. For a database, the workload consists of the database queries and commands sent by the clients.</li>
<li><strong>Cache</strong>: a fast storage area that can duplicate or buffer a limited amount of data, to avoid communicating directly with a slower tier of storage, thereby improving performance. For economic reasons, a cache is smaller than the slower tier.</li>
</ul>
<h3 id="models">Models</h3>
<h4 id="system-under-test">System under Test</h4>
<p>The performance of a <a href="https://en.wikipedia.org/wiki/System_under_test">system under test</a> (SUT) is shown below:</p>
<p><a href="../figure_2.1.png" title="Figure 2.1 System under test"><img alt="Figure 2.1 System under test" src="../figure_2.1.png" /></a></p>
<p><strong>Perturbations</strong> (interference) can affect results, including those caused by:</p>
<ul>
<li>Scheduled system activity,</li>
<li>Other users of the system,</li>
<li>Oher workloads.</li>
</ul>
<p>The origin of the perturbations may not be clear and determining it can be particularly difficult in some cloud environments, where other activity (by guest tenants) on the physical host system is not observable from within a guest SUT.</p>
<p>Another difficulty is that modern environments may be composed of several networked components needed to service the input workload, including load balancers, web servers, database servers, application servers, and storage systems. The mere act of mapping the environment may help to reveal previously overlooked sources of perturbations. The environment may also be modeled as a network of queueing systems, for analytical study.</p>
<h4 id="queueing-system">Queueing System</h4>
<p>Some components and resources can be modeled as a queueing system. The following figure shows a simple queueing system.</p>
<p><a href="../figure_2.2.png" title="Figure 2.2 Simple queueing model"><img alt="Figure 2.2 Simple queueing model" src="../figure_2.2.png" /></a></p>
<h3 id="concepts">Concepts</h3>
<h4 id="latency">Latency</h4>
<p>The <strong>latency</strong> is the time spent waiting before an operation is performed.  The following figure, as an example of latency, shows a network transfer (e.g. HTTP GET request):</p>
<p><a href="../figure_2.3.png" title="Figure 2.3 Network connection latency"><img alt="Figure 2.3 Network connection latency" src="../figure_2.3.png" /></a></p>
<p>In this example, the operation is a network service request to transfer data. Before this operation can take place, the system must wait for a network connection to be established, which is latency for this operation. The response time spans this latency and the operation time.</p>
<p>Depending on the target, the latency can be measured differently. For example, the load time for a website may be composed of three different times:</p>
<ul>
<li>DNS latency, which refers to the entire DNS operation.</li>
<li>TCP connection latency, which refers to the initialization only (TCP handshake).</li>
<li>TCP data transfer time.</li>
</ul>
<p>At a higher level, the response time may be termed latency. [p19]</p>
<p>Time orders of magnitude and their abbreviations are listed in the following table:</p>
<table>
<thead>
<tr>
<th>Unit</th>
<th>Abbreviation</th>
<th>Fraction of 1 s</th>
</tr>
</thead>
<tbody>
<tr>
<td>Minute</td>
<td>m</td>
<td>60</td>
</tr>
<tr>
<td>Second</td>
<td>s</td>
<td>1</td>
</tr>
<tr>
<td>Millisecond</td>
<td>ms</td>
<td>0.001 or 1/1000 or 1 x 10<sup>-3</sup></td>
</tr>
<tr>
<td>Microsecond</td>
<td>μs</td>
<td>0.000001 or 1/1000000 or 1 x 10<sup>-6</sup></td>
</tr>
<tr>
<td>Nanosecond</td>
<td>ns</td>
<td>0.000000001 or 1/1000000000 or 1 x 10<sup>-9</sup></td>
</tr>
<tr>
<td>Picosecond</td>
<td>ps</td>
<td>0.000000000001 or 1/1000000000000 or 1 x 10<sup>-12</sup></td>
</tr>
</tbody>
</table>
<p>When possible, other metric types can be converted to latency or time so that they can be compared. For example:</p>
<ul>
<li>Choosing the better performance between 100 network I/O or 50 disk I/O be a complicated choice, involving many factors: network hops, rate of network drops and retransmits, I/O size, random or sequential I/O, disk types, etc..</li>
<li>Comparing 100 ms of total network I/O and 50 ms of total disk I/O is easier.</li>
</ul>
<h4 id="time-scales">Time Scales</h4>
<p>System components operate over vastly different time scales (orders of magnitude).</p>
<p>The following table is an example Time Scale of System Latencies (3.3 GHz processor):</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Latency</th>
<th>Scaled</th>
</tr>
</thead>
<tbody>
<tr>
<td>1 CPU cycle</td>
<td>0.3 ns</td>
<td>1 s</td>
</tr>
<tr>
<td>Level 1 cache access</td>
<td>0.9 ns</td>
<td>3 s</td>
</tr>
<tr>
<td>Level 2 cache access</td>
<td>2.8 ns</td>
<td>9 s</td>
</tr>
<tr>
<td>Level 3 cache access</td>
<td>12.9 ns</td>
<td>43 s</td>
</tr>
<tr>
<td>Main memory access (DRAM, from CPU)</td>
<td>120 ns</td>
<td>6 min</td>
</tr>
<tr>
<td>Solid-state disk I/O (flash memory)</td>
<td>50–150 μs</td>
<td>2–6 days</td>
</tr>
<tr>
<td>Rotational disk I/O</td>
<td>1–10 ms</td>
<td>1–12 months</td>
</tr>
<tr>
<td>Internet: San Francisco to New York</td>
<td>40 ms</td>
<td>4 years</td>
</tr>
<tr>
<td>Internet: San Francisco to United Kingdom</td>
<td>81 ms</td>
<td>8 years</td>
</tr>
<tr>
<td>Internet: San Francisco to Australia</td>
<td>183 ms</td>
<td>19 years</td>
</tr>
<tr>
<td>TCP packet retransmit</td>
<td>1–3 s</td>
<td>105–317 years</td>
</tr>
<tr>
<td>OS virtualization system reboot</td>
<td>4 s</td>
<td>423 years</td>
</tr>
<tr>
<td>SCSI command time-out</td>
<td>30 s</td>
<td>3 millennia</td>
</tr>
<tr>
<td>Hardware (HW) virtualization system reboot</td>
<td>40 s</td>
<td>4 millennia</td>
</tr>
<tr>
<td>Physical system reboot</td>
<td>5 m</td>
<td>32 millennia</td>
</tr>
</tbody>
</table>
<h4 id="trade-offs">Trade-offs</h4>
<p>Be aware of some common performance trade-offs. The figure below shows the good/fast/cheap "pick two" trade-off on the left alongside the terminology adjusted for IT projects on the right.</p>
<p><a href="../figure_2.4.png" title="Figure 2.4 Trade-offs: pick two"><img alt="Figure 2.4 Trade-offs: pick two" src="../figure_2.4.png" /></a></p>
<p>A common trade-off in performance tuning is that between CPU and memory:</p>
<ul>
<li>Memory can be used to cache results, reducing CPU usage.</li>
<li>CPU may be spent to compress data to reduce memory usage. (On modern systems with an abundance of CPU)</li>
</ul>
<p>[p21]</p>
<p>Tunable parameters often come with trade-offs. For examples:</p>
<ul>
<li><strong>File system record size</strong> (or block size):<ul>
<li>Small record sizes, close to the application I/O size, will perform better for random I/O workloads and make more efficient use of the file system cache while the application is running.</li>
<li>Large record sizes will improve streaming workloads, including file system backups.</li>
</ul>
</li>
<li><strong>Network buffer size</strong>:<ul>
<li>Small buffer sizes will reduce the memory overhead per connection, helping the system scale.</li>
<li>Large sizes will improve network throughput.</li>
</ul>
</li>
</ul>
<h4 id="tuning-efforts">Tuning Efforts</h4>
<p><u>Performance tuning is most effective when done closest to where the work is performed (e.g. within application itself)).</u> The following table shows an example of software stack, with tuning possibilities.</p>
<table>
<thead>
<tr>
<th>Layer</th>
<th>Tuning Targets</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application</td>
<td>database queries performed</td>
</tr>
<tr>
<td>Database</td>
<td>database table layout, indexes, buffering</td>
</tr>
<tr>
<td>System calls</td>
<td>memory-mapped or read/write, sync or async I/O flags</td>
</tr>
<tr>
<td>File system</td>
<td>record size, cache size, file system tunables</td>
</tr>
<tr>
<td>Storage</td>
<td>RAID level, number and type of disks, storage tunables</td>
</tr>
</tbody>
</table>
<h5 id="application-level"><strong>Application Level</strong> *</h5>
<p>Tuning at the application level may improve performance significantly due to the following reasons:</p>
<ol>
<li>It may be possible to eliminate or reduce database queries and improve performance by a large factor (e.g., 20x).<ul>
<li>Tuning down to the storage device level may eliminate or improve storage I/O, but tuning efforts have already been made executing higher-level OS stack code, so this may improve resulting application performance by only percentages (e.g., 20%).</li>
</ul>
</li>
<li>Since many of today’s environments target rapid deployment for features and functionality, application development and testing tend to focus on correctness, leaving little or no time for performance measurement or optimization before production deployment. These activities are conducted later, when performance becomes a problem.</li>
</ol>
<p>The application isn’t necessarily the most effective level from which to base observation. Slow queries may be best understood from their time spent on-CPU, or from the file system and disk I/O that they perform. These are observable from operating system tools.</p>
<p>In many environments (especially cloud computing), the application level is under constant development, pushing software changes into production weekly or daily. Large performance improvment (including fixes for regressions) are frequently found as the application code changes. In these environments, tuning for the operating system and observability from the operating system can be easy to overlook. Remember that operating system performance analysis can also identify application-level issues, not just OS-level issues, in some cases more easily than from the application alone.</p>
<h4 id="level-of-appropriateness">Level of Appropriateness</h4>
<p>Different organizations and environments have different requirements for performance [p22]. This doesn’t necessarily mean that some organizations are doing it right and some wrong. It depends on the <a href="https://en.wikipedia.org/wiki/Return_on_investment">return on investment</a> (ROI) for performance expertise:</p>
<ul>
<li>Organizations with large data centers or cloud environments may need a team of performance engineers who analyze everything, including kernel internals and CPU performance counters, and frequently use dynamic tracing. They may also formally model performance and develop accurate predictions for future growth.</li>
<li>Small start-ups may have time only for superficial checks, trusting third-party monitoring solutions to check their performance and provide alerts.</li>
</ul>
<h4 id="point-in-time-recommendations">Point-in-Time Recommendations</h4>
<p>The performance characteristics of environments change over time, due to the addition of more users, newer hardware, and updated software or firmware.</p>
<p>[p23]</p>
<p>Performance recommendations, especially the values of tunable parameters, are valid only at a specific <em>point in time</em>. What may have been the best advice from a performance expert one week may become invalid a week later after a software or hardware upgrade, or after adding more users.</p>
<h4 id="load-versus-architecture">Load versus Architecture</h4>
<p>An application can perform badly due to an issue with the software configuration and hardware on which it is running: its architecture. However, an application can also perform badly simply due to too much load applied, resulting in queueing and long latencies. Load and architecture are pictured in the figure below:</p>
<p><a href="../figure_2.5.png" title="Figure 2.5 Load versus architecture"><img alt="Figure 2.5 Load versus architecture" src="../figure_2.5.png" /></a></p>
<p>If analysis of the architecture shows queueing of work but no problems with how the work is performed, the issue may be one of too much load applied. In a cloud computing environment, this is the point where more nodes can be introduced to handle the work.</p>
<h5 id="single-threaded-and-multithreaded-application"><strong>Single-threaded and multithreaded application</strong> *</h5>
<p>For example,</p>
<ul>
<li>An <strong>issue of architecture</strong> may be a single-threaded application that is busy on-CPU, with requests queueing while other CPUs are available and idle. In this case, performance is limited by the application’s single-threaded architecture.</li>
<li>An <strong>issue of load</strong> may be a multithreaded application that is busy on all available CPUs, with requests still queueing. In this case, performance is limited by the available CPU capacity, or put differently, by more load than the CPUs can handle.</li>
</ul>
<h4 id="scalability">Scalability</h4>
<p>The performance of the system under increasing load is its <strong>scalability</strong>. The following figure shows a typical throughput profile as a system’s load increases:</p>
<p><a href="../figure_2.6.png" title="Figure 2.6 Throughput versus load"><img alt="Figure 2.6 Throughput versus load" src="../figure_2.6.png" /></a></p>
<p>For some period, linear scalability is observed. A point is then reached, marked with a dotted line, where contention for a resource begins to affect performance. This point can be described as a <em>knee point</em>, as it is the boundary between two pro files. Beyond this point, the throughput profile departs from linear scalability, as contention for the resource increases. Eventually the overheads for increased contention and coherency cause less work to be completed and throughput to decrease.</p>
<p>This point may occur when a component reaches 100% utilization: the <em>saturation point</em>. It may also occur when a component approaches 100% utilization, and queueing begins to be frequent and significant. This point may occur when a component reaches 100% utilization: the saturation
point. It may also occur when a component approaches 100% utilization, and
queueing begins to be frequent and significant.</p>
<p>An example system that may exhibit this profile is an application that performs heavy compute, with more load added as threads. As the CPUs approach 100% utilization, performance begins to degrade as CPU scheduler latency increases. After peak performance, at 100% utilization, throughput begins to decrease as more threads are added, causing more context switches, which consume CPU resources and cause less actual work to be completed.</p>
<p>The same curve can be seen if you replace "load" on the <em>x</em> axis with a resource such as CPU cores (detailed in <a href="#modeling">Modeling</a>)</p>
<p>The degradation of performance for nonlinear scalability, in terms of average response time or latency, is graphed in the following figure:</p>
<p><a href="../figure_2.7.png" title="Figure 2.7 Performance degradation"><img alt="Figure 2.7 Performance degradation" src="../figure_2.7.png" /></a></p>
<ul>
<li>The "fast" degradation profile may occur for memory load, when the system begins to page (or swap) to supplement main memory.</li>
<li>The "slow" degradation profile may occur for CPU load.</li>
<li>Another "fast" profile example is disk I/O. As load (and the resulting disk utilization) increases, I/O becomes more likely to queue behind other I/O. An idle rotational disk may serve I/O with a response time of about 1 ms, but when load increases, this can approach 10 ms.</li>
</ul>
<p><u>Linear scalability of response time could occur if the application begins to return errors when resources are unavailable, instead of queueing work. For example, a web server may return 503 "Service Unavailable" instead of adding requests to a queue, so that those requests that are served can be performed with a consistent response time.</u></p>
<h4 id="known-unknowns">Known-Unknowns</h4>
<p>The following notions are important:</p>
<ul>
<li><strong>Known-knowns</strong>: These are things you know. You know you should be checking a performance metric, and you know its current value. For example, you know you should be checking CPU utilization, and you also know that the value is 10% on average.</li>
<li><strong>Known-unknowns</strong>: These are things you know that you do not know. You know you can check a metric or the existence of a subsystem, but you haven’t yet observed it. For example, you know you could be checking what is making the CPUs busy by the use of profiling but have yet to do so.</li>
<li><strong>Unknown-unknowns</strong>: These are things you do not know you do not know.  For example, you may not know that device interrupts can become heavy CPU consumers, so you are not checking them.</li>
</ul>
<p>Performance is a field where "the more you know, the more you don’t know". It’s the same principle: the more you learn about systems, the more unknownunknowns you become aware of, which are then known-unknowns that you can check on.</p>
<h4 id="metrics">Metrics</h4>
<p>Performance metrics are statistics generated by the system, applications, or additional tools that measure activity of interest. They are studied for performance analysis and monitoring, either numerically at the command line or graphically using visualizations.</p>
<p>Common types of systems performance metrics include:</p>
<ul>
<li><strong>IOPS</strong>: I/O operations per second</li>
<li><strong>Throughput</strong>: either operations or volume per second, depending on its context:<ul>
<li>Database throughput is usually a measure of queries or requests (operations) per second.</li>
<li>Network throughput is a measure of bits or bytes (volume) per second.</li>
</ul>
</li>
<li><strong>Utilization</strong></li>
<li><strong>Latency</strong></li>
</ul>
<h5 id="overhead"><strong>Overhead</strong></h5>
<p>Since CPU cycles must be spent to gather and store the metrics. This causes overhead, which can negatively affect the performance of the target of measurement. This is called the <a href="https://en.wikipedia.org/wiki/Observer_effect_(information_technology)"><strong>observer effect</strong></a>.</p>
<h5 id="issues"><strong>Issues</strong></h5>
<p>The temptation is to assume that the software vendor has provided metrics that are well chosen, are bug-free, and provide complete visibility. In reality, metrics can be confusing, complicated, unreliable, inaccurate, and even plain wrong (due to bugs). Sometimes a metric was correct on one software version but did not get updated to reflect the addition of new code and code paths.</p>
<h4 id="utilization">Utilization</h4>
<p>The term <em>utilization</em> is often used for operating systems to describe device usage, such as for the CPU and disk devices. Utilization can be time-based or capacitybased.</p>
<h5 id="time-based"><strong>Time-Based</strong></h5>
<p>Time-based utilization is the average amount of time the server or resource was busy, as defined in <a href="https://en.wikipedia.org/wiki/Queueing_theory">queueing theory</a>, along with the ratio:</p>
<blockquote>
<p><em>U</em> = <em>B</em>/<em>T</em></p>
</blockquote>
<p>where:</p>
<ul>
<li><em>U</em> = utilization</li>
<li><em>B</em> = total time the system was busy during <em>T</em>, the observation period</li>
</ul>
<p>The "utilization" is also available from operating system performance tools. The disk monitoring tool <a href="http://man7.org/linux/man-pages/man1/iostat.1.html"><code>iostat(1)</code></a> calls this metric <em>%b</em> for percent busy, a term that better conveys the underlying metric: <em>B</em>/<em>T</em>.</p>
<p>This utilization metric means how busy a component is: when a component approaches 100% utilization, performance can seriously degrade when there is contention for the resource. Other metrics can be checked to confirm and to see if the component has therefore become a system bottleneck.</p>
<p>Some components can service multiple operations in parallel. Performance may not degrade much at 100% utilization, as they can accept more work. [p28]</p>
<ul>
<li>A disk that is 100% busy may also be able to accept and process more work, for example, by buffering writes in the on-disk cache to be completed later.</li>
<li>Storage arrays frequently run at 100% utilization because some disk is busy 100% of the time, but the array has plenty of idle disks and can accept much more work.</li>
</ul>
<h5 id="capacity-based"><strong>Capacity-Based</strong></h5>
<p>The other definition of utilization in the context of capacity planning is:</p>
<blockquote>
<p>A system or component (such as a disk drive) is able to deliver a certain amount of throughput. At any level of performance, the system or component is working at some proportion of its capacity. That proportion is called the utilization.</p>
</blockquote>
<p>This defines utilization in terms of capacity instead of time. It implies that a disk at 100% utilization cannot accept any more work. With the time-based definition, 100% utilization only means it is busy 100% of the time. Therefore, <u>100% busy does not mean 100% capacity.</u></p>
<h5 id="time-based-vs-capacity-based"><strong>Time-Based vs. Capacity-Based</strong></h5>
<p>Use elevator as an example:</p>
<ul>
<li>Time-Based Utilization: the elevator may be considered utilized when it is moving between floors, and not utilized when it is idle waiting. However, the elevator may be able to accept more passengers even when it is busy 100% of the time responding to calls.</li>
<li>Capacity-Based Utilization: 100% capacity may mean the elevator is at its maximum payload capacity and cannot accept more passengers.</li>
</ul>
<p>In an ideal world, we would be able to measure both types of utilization for a device, which usually isn't possible. [p29]</p>
<p><u>In this book, <em>utilization</em> usually refers to the time-based version.</u> The capacity version is used for some volume-based metrics, such as memory usage.</p>
<h5 id="non-idle-time"><strong>Non-Idle Time</strong></h5>
<p><strong>Non-idle time</strong> is a more accurate term to define utilization, but not yet in common usage. [p29]</p>
<h4 id="saturation">Saturation</h4>
<h4 id="profiling">Profiling</h4>
<h4 id="caching">Caching</h4>
<h3 id="perspectives">Perspectives</h3>
<h3 id="methodology">Methodology</h3>
<h3 id="modeling">Modeling</h3>
<h3 id="capacity-planning">Capacity Planning</h3>
<h3 id="statistics">Statistics</h3>
<h3 id="monitoring">Monitoring</h3>
<h3 id="visualizations">Visualizations</h3>
<h3 id="doubts-and-solutions">Doubts and Solutions</h3>
<h4 id="verbatim">Verbatim</h4>
<p>p17 on System under Test:</p>
<blockquote>
<p>The mere act of mapping the environment may help to reveal previously overlooked sources of perturbations. The environment may also be modeled as a network of queueing systems, for analytical study.</p>
</blockquote>
<p>WTF?</p>
<p>p21 on Trade-offs:</p>
<blockquote>
<p>File system record size and network buffer size: small vs large</p>
</blockquote>
<p>Further reading may be required to understand these trade-offs.</p>
            </div>
        </div>

        <footer class="col-md-12">
            
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../custom.js"></script>
    </body>
</html>